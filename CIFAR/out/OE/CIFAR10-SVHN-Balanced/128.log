ic| len(dset): 73257
{'dataset': 'CIFAR10-SVHN', 'model': 'densenet', 'calibration': False, 'epochs': 100, 'learning_rate': 0.001, 'batch_size': 128, 'oe_batch_size': 256, 'test_bs': 200, 'momentum': 0.9, 'decay': 0.0005, 'layers': 40, 'widen_factor': 2, 'droprate': 0.3, 'save': './snapshots/oe_tune', 'load': './snapshots/pretrained', 'test': False, 'ngpu': 1, 'prefetch': 1, 'm_in': -25.0, 'm_out': -7.0, 'score': 'OE', 'seed': 1, 'regime': 'Balanced', 'n_ood': 128}
Files already downloaded and verified
Files already downloaded and verified
Using downloaded and verified file: ./Datasets/SVHN/train_32x32.mat
Using downloaded and verified file: ./Datasets/SVHN/test_32x32.mat
torch.Size([1280, 3, 32, 32])
Counter({0: 128, 1: 128, 2: 128, 3: 128, 4: 128, 5: 128, 6: 128, 7: 128, 8: 128, 9: 128})
Tesla V100-PCIE-16GB
Model restored!
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:21,  3.55it/s]  4%|▍         | 3/79 [00:00<00:08,  8.48it/s]  6%|▋         | 5/79 [00:00<00:06, 11.47it/s]  9%|▉         | 7/79 [00:00<00:05, 13.33it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.59it/s] 14%|█▍        | 11/79 [00:00<00:04, 15.42it/s] 16%|█▋        | 13/79 [00:00<00:04, 16.00it/s] 19%|█▉        | 15/79 [00:01<00:03, 16.39it/s] 22%|██▏       | 17/79 [00:01<00:03, 16.66it/s] 24%|██▍       | 19/79 [00:01<00:03, 16.86it/s] 27%|██▋       | 21/79 [00:01<00:03, 17.00it/s] 29%|██▉       | 23/79 [00:01<00:03, 17.10it/s] 32%|███▏      | 25/79 [00:01<00:03, 17.17it/s] 34%|███▍      | 27/79 [00:01<00:03, 17.23it/s] 37%|███▋      | 29/79 [00:01<00:02, 17.27it/s] 39%|███▉      | 31/79 [00:02<00:02, 17.29it/s] 42%|████▏     | 33/79 [00:02<00:02, 17.32it/s] 44%|████▍     | 35/79 [00:02<00:02, 17.34it/s] 47%|████▋     | 37/79 [00:02<00:02, 17.35it/s] 49%|████▉     | 39/79 [00:02<00:02, 17.35it/s] 52%|█████▏    | 41/79 [00:02<00:02, 17.36it/s] 54%|█████▍    | 43/79 [00:02<00:02, 17.38it/s] 57%|█████▋    | 45/79 [00:02<00:01, 17.38it/s] 59%|█████▉    | 47/79 [00:02<00:01, 17.38it/s] 62%|██████▏   | 49/79 [00:03<00:01, 17.24it/s] 65%|██████▍   | 51/79 [00:03<00:01, 17.29it/s] 67%|██████▋   | 53/79 [00:03<00:01, 17.31it/s] 70%|██████▉   | 55/79 [00:03<00:01, 17.34it/s] 72%|███████▏  | 57/79 [00:03<00:01, 17.36it/s] 75%|███████▍  | 59/79 [00:03<00:01, 17.38it/s] 77%|███████▋  | 61/79 [00:03<00:01, 17.38it/s] 80%|███████▉  | 63/79 [00:03<00:00, 17.39it/s] 82%|████████▏ | 65/79 [00:03<00:00, 17.40it/s] 85%|████████▍ | 67/79 [00:04<00:00, 17.42it/s] 87%|████████▋ | 69/79 [00:04<00:00, 17.43it/s] 90%|████████▉ | 71/79 [00:04<00:00, 17.43it/s] 92%|█████████▏| 73/79 [00:04<00:00, 17.44it/s] 95%|█████████▍| 75/79 [00:04<00:00, 17.45it/s] 97%|█████████▋| 77/79 [00:04<00:00, 17.46it/s]100%|██████████| 79/79 [00:04<00:00, 16.67it/s]
0.9130735759493671
0.3466225429614888
0.9128000000000001
Beginning Training

/home/xysong/.conda/envs/OoD/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch   1 | Time     7 | Train Loss 2.4521 | Test Loss 0.416 | Test Error 9.36
Epoch   2 | Time     5 | Train Loss 2.3274 | Test Loss 0.489 | Test Error 10.48
Epoch   3 | Time     5 | Train Loss 2.2128 | Test Loss 0.537 | Test Error 11.20
Epoch   4 | Time     5 | Train Loss 2.0626 | Test Loss 0.570 | Test Error 11.68
Epoch   5 | Time     5 | Train Loss 1.9542 | Test Loss 0.595 | Test Error 11.89
Epoch   6 | Time     5 | Train Loss 1.8718 | Test Loss 0.615 | Test Error 12.07
Epoch   7 | Time     5 | Train Loss 1.7910 | Test Loss 0.624 | Test Error 12.20
Epoch   8 | Time     5 | Train Loss 1.7038 | Test Loss 0.632 | Test Error 12.27
Epoch   9 | Time     5 | Train Loss 1.6464 | Test Loss 0.636 | Test Error 12.30
Epoch  10 | Time     5 | Train Loss 1.5979 | Test Loss 0.636 | Test Error 12.31
Epoch  11 | Time     5 | Train Loss 1.5762 | Test Loss 0.639 | Test Error 12.34
Epoch  12 | Time     5 | Train Loss 1.4980 | Test Loss 0.637 | Test Error 12.25
Epoch  13 | Time     5 | Train Loss 1.4688 | Test Loss 0.635 | Test Error 12.22
Epoch  14 | Time     5 | Train Loss 1.4460 | Test Loss 0.633 | Test Error 12.09
Epoch  15 | Time     5 | Train Loss 1.3862 | Test Loss 0.632 | Test Error 12.14
Epoch  16 | Time     5 | Train Loss 1.3705 | Test Loss 0.638 | Test Error 12.17
Epoch  17 | Time     5 | Train Loss 1.3264 | Test Loss 0.640 | Test Error 12.26
Epoch  18 | Time     5 | Train Loss 1.3232 | Test Loss 0.643 | Test Error 12.29
Epoch  19 | Time     5 | Train Loss 1.2831 | Test Loss 0.642 | Test Error 12.28
Epoch  20 | Time     5 | Train Loss 1.2837 | Test Loss 0.636 | Test Error 12.26
Epoch  21 | Time     5 | Train Loss 1.2459 | Test Loss 0.638 | Test Error 12.20
Epoch  22 | Time     5 | Train Loss 1.2296 | Test Loss 0.640 | Test Error 12.25
Epoch  23 | Time     5 | Train Loss 1.2170 | Test Loss 0.638 | Test Error 12.22
Epoch  24 | Time     5 | Train Loss 1.1817 | Test Loss 0.639 | Test Error 12.34
Epoch  25 | Time     5 | Train Loss 1.1887 | Test Loss 0.643 | Test Error 12.39
Epoch  26 | Time     5 | Train Loss 1.1615 | Test Loss 0.643 | Test Error 12.28
Epoch  27 | Time     5 | Train Loss 1.1772 | Test Loss 0.645 | Test Error 12.26
Epoch  28 | Time     5 | Train Loss 1.1474 | Test Loss 0.642 | Test Error 12.18
Epoch  29 | Time     5 | Train Loss 1.1324 | Test Loss 0.638 | Test Error 12.20
Epoch  30 | Time     5 | Train Loss 1.1280 | Test Loss 0.639 | Test Error 12.21
Epoch  31 | Time     5 | Train Loss 1.1115 | Test Loss 0.645 | Test Error 12.30
Epoch  32 | Time     5 | Train Loss 1.1124 | Test Loss 0.643 | Test Error 12.25
Epoch  33 | Time     5 | Train Loss 1.0943 | Test Loss 0.640 | Test Error 12.22
Epoch  34 | Time     5 | Train Loss 1.1122 | Test Loss 0.634 | Test Error 12.14
Epoch  35 | Time     5 | Train Loss 1.0700 | Test Loss 0.628 | Test Error 12.09
Epoch  36 | Time     5 | Train Loss 1.0753 | Test Loss 0.625 | Test Error 12.06
Epoch  37 | Time     5 | Train Loss 1.0609 | Test Loss 0.624 | Test Error 12.03
Epoch  38 | Time     5 | Train Loss 1.0407 | Test Loss 0.624 | Test Error 12.02
Epoch  39 | Time     5 | Train Loss 1.0345 | Test Loss 0.626 | Test Error 12.06
Epoch  40 | Time     5 | Train Loss 1.0494 | Test Loss 0.627 | Test Error 12.07
Epoch  41 | Time     5 | Train Loss 1.0477 | Test Loss 0.625 | Test Error 12.00
Epoch  42 | Time     5 | Train Loss 1.0345 | Test Loss 0.624 | Test Error 12.03
Epoch  43 | Time     5 | Train Loss 1.0106 | Test Loss 0.623 | Test Error 12.02
Epoch  44 | Time     5 | Train Loss 1.0133 | Test Loss 0.623 | Test Error 11.96
Epoch  45 | Time     5 | Train Loss 1.0091 | Test Loss 0.629 | Test Error 12.06
Epoch  46 | Time     5 | Train Loss 1.0095 | Test Loss 0.628 | Test Error 12.08
Epoch  47 | Time     5 | Train Loss 0.9893 | Test Loss 0.623 | Test Error 12.07
Epoch  48 | Time     5 | Train Loss 0.9985 | Test Loss 0.627 | Test Error 12.18
Epoch  49 | Time     5 | Train Loss 0.9915 | Test Loss 0.629 | Test Error 12.17
Epoch  50 | Time     5 | Train Loss 0.9961 | Test Loss 0.628 | Test Error 12.14
Epoch  51 | Time     5 | Train Loss 0.9771 | Test Loss 0.625 | Test Error 12.17
Epoch  52 | Time     5 | Train Loss 0.9762 | Test Loss 0.625 | Test Error 12.16
Epoch  53 | Time     5 | Train Loss 0.9887 | Test Loss 0.628 | Test Error 12.20
Epoch  54 | Time     5 | Train Loss 0.9767 | Test Loss 0.624 | Test Error 12.16
Epoch  55 | Time     5 | Train Loss 0.9562 | Test Loss 0.619 | Test Error 12.10
Epoch  56 | Time     5 | Train Loss 0.9595 | Test Loss 0.624 | Test Error 12.18
Epoch  57 | Time     5 | Train Loss 0.9538 | Test Loss 0.624 | Test Error 12.11
Epoch  58 | Time     5 | Train Loss 0.9545 | Test Loss 0.620 | Test Error 12.04
Epoch  59 | Time     5 | Train Loss 0.9627 | Test Loss 0.620 | Test Error 12.03
Epoch  60 | Time     5 | Train Loss 0.9561 | Test Loss 0.618 | Test Error 12.04
Epoch  61 | Time     5 | Train Loss 0.9525 | Test Loss 0.622 | Test Error 12.04
Epoch  62 | Time     5 | Train Loss 0.9402 | Test Loss 0.623 | Test Error 12.03
Epoch  63 | Time     5 | Train Loss 0.9359 | Test Loss 0.619 | Test Error 12.02
Epoch  64 | Time     5 | Train Loss 0.9342 | Test Loss 0.616 | Test Error 11.95
Epoch  65 | Time     5 | Train Loss 0.9405 | Test Loss 0.619 | Test Error 11.93
Epoch  66 | Time     5 | Train Loss 0.9421 | Test Loss 0.614 | Test Error 11.93
Epoch  67 | Time     5 | Train Loss 0.9331 | Test Loss 0.614 | Test Error 12.00
Epoch  68 | Time     5 | Train Loss 0.9221 | Test Loss 0.609 | Test Error 11.95
Epoch  69 | Time     5 | Train Loss 0.9388 | Test Loss 0.610 | Test Error 11.96
Epoch  70 | Time     5 | Train Loss 0.9347 | Test Loss 0.610 | Test Error 12.02
Epoch  71 | Time     5 | Train Loss 0.9154 | Test Loss 0.606 | Test Error 11.93
Epoch  72 | Time     5 | Train Loss 0.9133 | Test Loss 0.602 | Test Error 11.98
Epoch  73 | Time     5 | Train Loss 0.9232 | Test Loss 0.603 | Test Error 11.98
Epoch  74 | Time     6 | Train Loss 0.9085 | Test Loss 0.602 | Test Error 11.98
Epoch  75 | Time     5 | Train Loss 0.9131 | Test Loss 0.603 | Test Error 12.01
Epoch  76 | Time     5 | Train Loss 0.9070 | Test Loss 0.598 | Test Error 11.95
Epoch  77 | Time     5 | Train Loss 0.8970 | Test Loss 0.596 | Test Error 11.96
Epoch  78 | Time     5 | Train Loss 0.9045 | Test Loss 0.599 | Test Error 12.01
Epoch  79 | Time     5 | Train Loss 0.9062 | Test Loss 0.598 | Test Error 11.92
Epoch  80 | Time     5 | Train Loss 0.8995 | Test Loss 0.595 | Test Error 11.93
Epoch  81 | Time     5 | Train Loss 0.9082 | Test Loss 0.596 | Test Error 11.92
Epoch  82 | Time     5 | Train Loss 0.8919 | Test Loss 0.594 | Test Error 11.85
Epoch  83 | Time     5 | Train Loss 0.8969 | Test Loss 0.597 | Test Error 11.90
Epoch  84 | Time     5 | Train Loss 0.9079 | Test Loss 0.602 | Test Error 11.96
Epoch  85 | Time     5 | Train Loss 0.9056 | Test Loss 0.596 | Test Error 11.91
Epoch  86 | Time     5 | Train Loss 0.8928 | Test Loss 0.595 | Test Error 11.86
Epoch  87 | Time     5 | Train Loss 0.8870 | Test Loss 0.598 | Test Error 11.98
Epoch  88 | Time     5 | Train Loss 0.8890 | Test Loss 0.595 | Test Error 11.88
Epoch  89 | Time     5 | Train Loss 0.9000 | Test Loss 0.594 | Test Error 11.83
Epoch  90 | Time     5 | Train Loss 0.8952 | Test Loss 0.592 | Test Error 11.85
Epoch  91 | Time     6 | Train Loss 0.8851 | Test Loss 0.592 | Test Error 11.81
Epoch  92 | Time     5 | Train Loss 0.8766 | Test Loss 0.592 | Test Error 11.79
Epoch  93 | Time     5 | Train Loss 0.8789 | Test Loss 0.590 | Test Error 11.88
Epoch  94 | Time     5 | Train Loss 0.8859 | Test Loss 0.589 | Test Error 11.86
Epoch  95 | Time     5 | Train Loss 0.8805 | Test Loss 0.590 | Test Error 11.87
Epoch  96 | Time     5 | Train Loss 0.8889 | Test Loss 0.586 | Test Error 11.88
Epoch  97 | Time     5 | Train Loss 0.8841 | Test Loss 0.584 | Test Error 11.70
Epoch  98 | Time     5 | Train Loss 0.8666 | Test Loss 0.587 | Test Error 11.70
Epoch  99 | Time     5 | Train Loss 0.8732 | Test Loss 0.585 | Test Error 11.70
Epoch 100 | Time     5 | Train Loss 0.9008 | Test Loss 0.584 | Test Error 11.72
Namespace(dataset='CIFAR10-SVHN', test_bs=200, num_to_avg=5, validate=False, use_xent=False, method_name='cifar10_allconv_baseline', layers=40, widen_factor=2, droprate=0.3, load='./snapshots', ngpu=1, prefetch=1, out_as_pos=True, score='MSP', T=1.0, noise=0, type='OE', ft_epochs=99, ft_n=128, regime='Balanced')
Files already downloaded and verified
Files already downloaded and verified
Model restored!
Error Rate 11.72


Error Detection
			cifar10_allconv_baseline
FPR95:			64.47
FPR99:			42.50
AUROC:			89.62
AUPR:			50.19
Configuration: CIFAR10-SVHN_Balanced_128
Using downloaded and verified file: ./Datasets/SVHN/test_32x32.mat

CIFAR10-SVHN Detection

[-1.         -0.9999999  -0.99959964] [-0.17102759 -0.16065338 -0.38573122]
				cifar10_allconv_baseline
  TPR95 TPR99 AUROC AUPR
97.66 & 88.47 & 99.55 & 98.37
0.55 & 0.59 & 0.03 & 0.09
